var Pickl=function(a){var b={};b.form={width:320,height:520},b.config=this.Config,b.theme=this.Config.themes.plain,b.svg=null,b.callback=function(a){console.log(a)},_.extend(this,b,a),this.render()};Pickl.prototype.Config=function(){var a={};a.plain={},a.plain.background="#e2e2e2",a.plain.fieldset="#666666",a.plain.touchTarget="#f2f2f2",a.plain.touchTargetOver="#000000",a.plain.buttonTextColor="#999999",a.plain.buttonTextColorOver="#e2e2e2",a.plain.buttonStroke="#e2e2e2",a.plain.modalBackground="#f2f2f2";var b={};b.name="Orientation",b.values=["righty","lefty"],b.selected=0;var c={};c.name="Instrument",c.values=["guitar","banjo","ukelele"],c.selected=0;var d={};d.name="Strings",d.values=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],d.selected=0;var e={};return e.themes=a,e.title="Options",e.fields=[b,c,d],e}(),Pickl.prototype.render=function(){this.pickl=this.renderForm(),this.pickl.theme=this.renderTheme(),this.pickl.background=this.renderBackground(),this.pickl.title=this.renderTitle(),this.pickl.close=this.renderClose(),this.pickl.fields=this.renderFields()},Pickl.prototype.renderForm=function(){var a=null===this.svg?Snap(this.form.width,this.form.height):this.svg,b=a.attr("class")+" pickl";return a.attr({"class":b,transform:"translate("+this.form.width+",0)"}),a},Pickl.prototype.renderTheme=function(){var a=$("<style>");return a.attr("type","text/css"),a.attr("class","picklTheme"),a.append(".pickl .background { fill: "+this.theme.background+"; }"),a.append(".pickl .fieldset { fill: "+this.theme.fieldset+"; }"),a.append(".pickl .button > .touchTarget, .pickl .field .touchTarget { fill: "+this.theme.touchTarget+"; }"),a.append(".pickl .button > .touchTarget { stroke: "+this.theme.buttonStroke+"; }"),a.append(".pickl .button:hover .touchTarget { fill: "+this.theme.touchTargetOver+"; }"),a.append(".pickl .button:hover text { fill: "+this.theme.buttonTextColorOver+"; }"),a.append(".pickl .button > .arrow > .touchTarget { fill: "+this.theme.touchTarget+" }"),$("head").append(a),a},Pickl.prototype.renderBackground=function(){var a=this.pickl.rect(0,0,this.form.width,this.form.height);return a.attr({"class":"background"}),a},Pickl.prototype.renderTitle=function(){var a=this.pickl.text(this.form.width/2,50,this.config.title);return a.attr({"class":"title"}),a},Pickl.prototype.renderClose=function(){{var a=this.pickl.g().attr("class","button close"),b=.15*this.form.width/2,c=this.form.height-70,d=.85*this.form.width,e=50;a.rect(b,c,d,e).attr({"class":"touchTarget"}),a.text(this.form.width/2,c+25,"close")}return a.click(this.save,this),a},Pickl.prototype.renderFields=function(){var a=this,b=this.calcLayout().fields,c=this.pickl.g().attr("class","fields"),d=90;return _.each(this.config.fields,function(e,f){{var g=c.g().attr({"class":"field button",transform:"translate("+b.x+","+d+")"});g.rect(0,0,b.width,40).attr({"class":"touchTarget"}),g.text(b.x+70,20,e.name).attr({"class":"title"}),g.text(b.x+80,20,e.values[e.selected]).attr("class","value")}d+=41,g.click(function(){a.displayOptions(f)},a)}),c.selectAll(".field")},Pickl.prototype.renderOptions=function(a){{var b=this,c=b.calcLayout().fields,d=this.pickl.g().attr({"class":"options"}),e=this.config.fields[a],f=(d.rect(0,0,b.form.width,b.form.height).attr("class","background"),d.text(b.form.width/2,27,e.name).attr("class","title options"),d.g().attr({"class":"fields"})),g=e.values[e.selected],h=50,i=c.x-1;this.pickl.fields[a]}return d.attr({transform:"translate("+this.form.width+",0)"}),_.each(e.values,function(j,k){var l=f.g().attr({"class":"field",transform:"translate("+i+","+h+")"}),m=(l.rect(0,0,c.width/2,40).attr({"class":"touchTarget"}),l.text(40,20,j).attr({"class":"value"}),j===g?"check selected":"check"),n=l.g().attr({"class":m}),o=(n.rect(0,0,40,40).attr({"class":"touchTarget"}),n.text(10,20,"*").attr({"class":"value"}));o.node.innerHTML="&#xf00c",h=k%2===0?h:h+41,i=k%2===0?c.width/2+c.x+1:c.x-1,n.click(function(){e.selected=k,d.animate({transform:"translate("+this.form.width+",0)"},200,mina.easeout,function(){this.remove()}),b.pickl.fields[a].select(".value").node.textContent=j},b)}),d},Pickl.prototype.calcLayout=function(){var a={};return a.fields=this.calcFields(),a},Pickl.prototype.calcFields=function(){var a=40,b=.85*this.form.width,c=.15*this.form.width/2;return{height:a,width:b,x:c}},Pickl.prototype.display=function(){this.pickl.animate({transform:"translate(0,0)"},200,mina.easein)},Pickl.prototype.displayOptions=function(a){var b=this.renderOptions(a);b.animate({transform:"translate(0,0)"},200,mina.easin)},Pickl.prototype.save=function(){var a={};_.each(this.config.fields,function(b){a[b.name]=b.values[b.selected]}),this.callback(a),this.pickl.animate({transform:"translate("+this.form.width+",0)"},200,mina.easein)};